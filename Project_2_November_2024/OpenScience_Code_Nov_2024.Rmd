---
title: "Combined Code"
author: "Haya"
date: "2024-04-28"
output: html_document
---

#Import the dataset
```{r}
#import the used library and the csv Data File

library(dplyr)
library(lubridate)
library(ggplot2)
library(tidyr)
library(scales)
library(MASS)
library(extrafont)
library(forcats)


data <- read.csv ("OpenScienceData_Nov_2024.csv")
head(data)
```
#Paper/years
```{r}
# Count the number of papers per year
aggregated_data <- data %>%
  group_by(Year) %>%
  summarise(total_papers = n())

# Create the bar chart
year <- ggplot(aggregated_data, aes(x = as.factor(Year), y = total_papers)) +
  geom_bar(stat = "identity", fill = "#1A56BB") +
  geom_text(aes(label = total_papers), vjust = -0.5) +
  labs(x = "Year", y = "Total Number of Papers", title = "Total Number of Papers by Year") +
  theme_minimal()

print(year)

#This figure was only used for illustartion, not used in publication, 

```

#1 - Descriptive Statistics

#paper/type
```{r}
type_frequency <- table(data$Type)
print(type_frequency) #these results were used in the table s1 of the publication
```

#n% paper/year
```{r}
total_counts_by_type <- data %>%
  group_by(Type) %>%
  summarise(Total = n(), .groups = "drop")

# Calculate frequency and percentage for each Type and Year
summarized_data <- data %>%
  group_by(Year, Type) %>%
  summarise(count = n(), .groups = "drop") %>%
  left_join(total_counts_by_type, by = "Type") %>%
  mutate(Percentage = (count / Total) * 100)
  
print(summarized_data) 
```




#Plot_Papers/years --- the distribution of the included papers over the years
```{r}
aggregated_data <- data %>%
  group_by(Year, Type) %>%
  summarise(count = n(), .groups = "drop")

# Create the clustered bar chart with numbers on top of the bars and specified colors
year <- ggplot(aggregated_data, aes(x = as.factor(Year), y = count, fill = Type)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = count), position = position_dodge(width = 0.9), vjust = -0.5) +
  scale_fill_manual(values = c("#E88D5E","#B8D96C", "#B77AB9","#5271A9")) +
  labs(x = "Year", y = "Number of Papers", title = "Number of Papers by Year") +
  theme_minimal()

print(year)

ggsave("year.png", year, width = 10, height = 8, dpi = 300, bg="white")

#This figure was only used for illustartion, not used in publication
```

#DataShare ---Frequency and Percentage of the papers that share data (Data Sharing= Data Completeness score >1) Overall
```{r}

data <- data %>%
  mutate(Period = ifelse(Complete > 1, "Shared", "No Share"))

# Calculate the total number of papers for each period
period_totals <- data %>%
  group_by(Period) %>%
  summarise(Total = n(), .groups = "drop")

# Calculate the grand total of all papers
grand_total <- sum(period_totals$Total)

# Add a column for the percentage of each period's total relative to the grand total
period_totals <- period_totals %>%
  mutate(Percentage = (Total / grand_total) * 100)

# Print the period totals and percentages
print(period_totals) 

#these results were used in the table 1 of the publication
```


#DataShare_byType --- Frequency and Percentage of the papers that share data (Data Sharing= Data Completeness score >1) by Type
```{r}

total_counts_by_type <- data %>%
  group_by(Type) %>%
  summarise(Total = n(), .groups = "drop")

# Categorize based on Completeness, calculate frequency and percentage for each Type
summarized_data <- data %>%
  filter(Complete == 1 | Complete > 1) %>%
  mutate(Category = ifelse(Complete == 1, "Completeness = 1", "Completeness > 1")) %>%
  group_by(Category, Type) %>%
  summarise(count = n(), .groups = "drop") %>%
  left_join(total_counts_by_type, by = "Type") %>%
  mutate(Percentage = (count / Total) * 100)

print(summarized_data) 

#these results were used in the table 1 of the publication

```

#Preprint ---- Frequemcy and percentage of preprints 
```{r}
# Calculate frequency and percentage for each Preprints category, across all types
preprints_summary <- data %>%
  group_by(Preprints) %>%
  summarise(count = n(), .groups = "drop") 

# Calculate the overall total
overall_total <- sum(preprints_summary$count)

# Add a column for the percentage of each Preprints category relative to the overall total
preprints_summary <- preprints_summary %>%
  mutate(percentage = (count / overall_total) * 100)

# Print the summary
print(preprints_summary)

# Frequency and Percentage of the papers with preprints
data %>%
  group_by(Type, Preprints) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(Type) %>%
  mutate(total = sum(count), 
         percentage = (count/total)*100) %>%
  ungroup() %>%
  arrange(Type, Preprints)
#these results were used in the table 1 of the publication
```

#DAS -- Frequemcy and percentage of Data Availibilty Statement 
```{r}
DAS_summary <- data %>%
  group_by(DAS) %>%
  summarise(count = n(), .groups = "drop") 

# Calculate the overall total
overall_total <- sum(DAS_summary$count)

# Add a column for the percentage of each DAS category relative to the overall total
DAS_summary <- DAS_summary %>%
  mutate(percentage = (count / overall_total) * 100)

print(DAS_summary)

data$DAS <- as.factor(data$DAS)

# Frequency and Percentage of the papers with DAS in the publications
data %>%
  group_by(Type, DAS) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(Type) %>%
  mutate(total = sum(count), 
         percentage = (count/total)*100) %>%
  ungroup() %>%
  arrange(Type, DAS) 

#these results were used in the table 1 of the publication
```
#CodeSharing --- Calculate frequency and percentage for Code Sharing
```{r}
CodeArchived_summary <- data %>%
  group_by(CodeArchived) %>%
  summarise(count = n(), .groups = "drop") 

# Calculate the overall total
overall_total <- sum(CodeArchived_summary$count)

# Add a column for the percentage of each DAS category relative to the overall total
CodeArchived_summary <- CodeArchived_summary %>%
  mutate(percentage = (count / overall_total) * 100)

print(CodeArchived_summary)

# Frequency and Percentage of the papers that shared the code used
data %>%
  group_by(Type, CodeArchived) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(Type) %>%
  mutate(total = sum(count), 
         percentage = (count/total)*100) %>%
  ungroup() %>%

  arrange(Type, CodeArchived)

#these results were used in the table 1 of the publication
```

#Analysis Program
```{r}
AnalysisPgrm_summary <- data %>%
  group_by(AnalysisPgrm) %>%
  summarise(count = n(), .groups = "drop") 

# Calculate the overall total
overall_total <- sum(AnalysisPgrm_summary$count)

# Add a column for the percentage of each DAS category relative to the overall total
AnalysisPgrm_summary <- AnalysisPgrm_summary %>%
  mutate(percentage = (count / overall_total) * 100)

print(AnalysisPgrm_summary)

# Frequency and Percentage of the papers that shared the code used
data %>%
  group_by(Type, AnalysisPgrm) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(Type) %>%
  mutate(total = sum(count), 
         percentage = (count/total)*100) %>%
  ungroup() %>%

  arrange(Type, AnalysisPgrm)

#these results were used in the table 1 of the publication
```

#Image --- Calculate frequency and percentage for Image
```{r}
Image_summary <- data %>%
  group_by(Image) %>%
  summarise(count = n(), .groups = "drop") 

# Calculate the overall total
overall_total <- sum(Image_summary$count)


Image_summary <- Image_summary %>%
  mutate(percentage = (count / overall_total) * 100)

print(Image_summary)

# Frequency and Percentage of the papers that shared the Image
data %>%
  group_by(Type, Image) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(Type) %>%
  mutate(total = sum(count), 
         percentage = (count/total)*100) %>%
  ungroup() %>%

  arrange(Type, Image)

#these results were used in the table s4 of the publication
```

#Genomic --- Calculate frequency and percentage for Genomic
```{r}
Genomics_summary <- data %>%
  group_by(Genomics) %>%
  summarise(count = n(), .groups = "drop") 

# Calculate the overall total
overall_total <- sum(Genomics_summary$count)


Genomics_summary <- Genomics_summary %>%
  mutate(percentage = (count / overall_total) * 100)

print(Genomics_summary)

# Frequency and Percentage of the papers that shared the Genomics
data %>%
  group_by(Type, Genomics) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(Type) %>%
  mutate(total = sum(count), 
         percentage = (count/total)*100) %>%
  ungroup() %>%

  arrange(Type, Genomics)

#these results were used in the table s4 of the publication
```


#Human --- Calculate frequency and percentage for Human
```{r}
Human_summary <- data %>%
  group_by(Human) %>%
  summarise(count = n(), .groups = "drop") 

# Calculate the overall total
overall_total <- sum(Human_summary$count)


Human_summary <- Human_summary %>%
  mutate(percentage = (count / overall_total) * 100)

print(Human_summary)

# Frequency and Percentage of the papers that shared the Human
data %>%
  group_by(Type, Human) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(Type) %>%
  mutate(total = sum(count), 
         percentage = (count/total)*100) %>%
  ungroup() %>%

  arrange(Type, Human)

#these results were used in the table s4 of the publication
```

#Complete/type --- Calculate frequency and percentage for Completeness Score
```{r}
Complete_summary <- data %>%
  group_by(Complete) %>%
  summarise(count = n(), .groups = "drop") 

# Calculate the overall total
overall_total <- sum(Complete_summary$count)


Complete_summary <- Complete_summary %>%
  mutate(percentage = (count / overall_total) * 100)

print(Complete_summary)

# Frequency and Percentage of the papers that shared the Complete
data %>%
  group_by(Type, Complete) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(Type) %>%
  mutate(total = sum(count), 
         percentage = (count/total)*100) %>%
  ungroup() %>%

  arrange(Type, Complete)

#these results were used in the table 1 of the publication
```


#Storage_Repository
```{r}
Storage_summary <- data %>%
  group_by(Storage) %>%
  summarise(count = n(), .groups = "drop") 

# Calculate the overall total
overall_total <- sum(Storage_summary$count)


Storage_summary <- Storage_summary %>%
  mutate(percentage = (count / overall_total) * 100)

print(Storage_summary)

# Frequency and Percentage of the papers that shared the Storage
data %>%
  group_by(Type, Storage) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(Type) %>%
  mutate(total = sum(count), 
         percentage = (count/total)*100) %>%
  ungroup() %>%

  arrange(Type, Storage)

#these results were used in the table s4 of the publication
```


#Plot/ ALL Criteria
```{r}

# Convert all relevant columns to factors first to avoid the error
data <- data %>%
  mutate(across(c(Complete, Reuse, Access, Licence), as.character))  # Converts to character to ensure compatibility

# Reshape data to long format
long_data <- data %>%
  pivot_longer(cols = c(Complete, Reuse, Access, Licence), names_to = "Category", values_to = "Value") %>%
  mutate(Value = as.character(Value))  # Ensure that Value is a character

# Rename and reorder categories
long_data$Category <- recode(long_data$Category, 
                             "Complete" = "Completeness",
                             "Reuse" = "Reusability",
                             "Access" = "Accessibility",
                             "Licence" = "Licence")
long_data$Category <- factor(long_data$Category, levels = c("Completeness", "Reusability", "Accessibility", "Licence"))

long_data <- long_data %>%
  mutate(Value = factor(Value, levels = c("4", "3", "2", "1")))

# Calculate counts and percentages
long_data <- long_data %>%
  group_by(Category, Value) %>%
  summarise(Count = n(), .groups = "drop") %>%
  ungroup() %>%
  group_by(Category) %>%
  mutate(Total = sum(Count),
         Percentage = Count / Total * 100) %>%
  ungroup() %>%
  arrange(Category, desc(Value)) %>%
  group_by(Category) %>%
  mutate(Label = ifelse(Count > 5, paste0(Count, " (", round(Percentage, 1), "%)"), ""),
         CumCount = cumsum(Count) - (0.5 * Count)) %>%
  ungroup()

# Plot
Figure_1 <- ggplot(long_data, aes(x = Category, y = Count, fill = Value)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values = c("#E88D5E","#B8D96C", "#B77AB9","#5271A9")) +
  labs(y = "Count", fill = "Score") +
  
  # Label text size set to 9pt (around size = 3 in ggplot2 units) with Times New Roman font
  geom_text(aes(label = Label, y = CumCount), family = "Times New Roman", size = 3, color = "black") +
  
  # Set font to Times New Roman, adjusting label and title sizes, and color to black
  theme(
    axis.title = element_text(size = 11, color = "black", family = "Times New Roman"),  # Axis titles in Times New Roman, 11pt, black
    axis.text = element_text(size = 9, color = "black", family = "Times New Roman"),    # Axis text in Times New Roman, 9pt, black
    legend.title = element_text(size = 9, color = "black", family = "Times New Roman"), # Legend title to 11pt, black
    legend.text = element_text(size = 9, color = "black", family = "Times New Roman")    # Legend text to 9pt, black
  ) +
  ylim(0, NA)

# Show the plot
print(Figure_1) #these results were used in the figure 1 of the publication

# Save the plot with a smaller width and height to balance with font size
ggsave("Figure_1.png", Figure_1, width = 7, height = 5, units = "in", bg = "white")  # Adjusted size to 7x5 inches


#this figure is the figure 1 of the publication
```

```{r}
aggregated_data <- data %>%
  group_by(Type, Complete) %>%
  summarise(count = n(), .groups = "drop")

# Create the clustered bar chart with numbers on top of the bars and specified colors
Complete <- ggplot(aggregated_data, aes(x = as.factor(Type), y = count, fill = Complete)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = count), position = position_dodge(width = 0.9), vjust = -0.5) +
  scale_fill_manual(values = c("#5271A9", "#B77AB9","#B8D96C","#E88D5E")) +
  labs(x = "Year", y = "Number of Papers", title = "Number of Papers by Year") +
  theme_minimal()

print(Complete)

ggsave("Complete.png", Complete, width = 10, height = 8, dpi = 300, bg="white")
```

#Plot_Complete/Year
```{r}

# Calculate the frequency and percentage for each 'Complete' score within each 'Year'
long_data <- data %>%
  count(Year, Complete) %>%
  group_by(Year) %>%
  mutate(Percentage = n / sum(n) * 100) %>%
  mutate(Label = ifelse(Percentage > 5, paste0(round(Percentage, 1), "%"), "")) %>%
  mutate(Cumulative_Percentage = cumsum(Percentage) - (0.5 * Percentage)) %>%
  ungroup()

long_data <- long_data %>%
  mutate(Complete = factor(Complete, levels = c("4", "3", "2", "1")))

# Custom colors
colors <- c("#E88D5E","#B8D96C", "#B77AB9","#5271A9")

# Creating the stacked bar chart with percentage labels
Figure_2_1 <- ggplot(long_data, aes(x = as.factor(Year), y = n, fill = as.factor(Complete))) +
  geom_bar(stat = "identity", position = "fill") +  # Scale the bar heights to proportions
  scale_y_continuous(labels = percent_format()) +    # Convert the y-axis to percentage
  geom_text(
    aes(label = Label, y = Percentage / 100),        # Adjusted to place label within filled bars
    family = "Times New Roman",
    size = 3,                                        # Approximately 9pt
    color = "black", 
    position = position_fill(vjust = 0.5)
  ) +
  scale_fill_manual(values = colors) +
  labs(
    x = "Year",
    y = "Percentage",
    fill = "Completeness"
  ) +
    ggtitle("(a)") +
  theme_minimal(base_family = "Times New Roman") +   # Base font set to Times New Roman
  theme(
    plot.title = element_text(size = 11, hjust = 0, color = "black", family = "Times New Roman"), # Title aligned left
    axis.title = element_text(size = 11, color = "black"),      # Axis titles in Times New Roman, 11pt
    axis.text = element_text(size = 9, color = "black"),        # Axis text in Times New Roman, 9pt
    legend.title = element_text(size = 11, color = "black"),    # Legend title in Times New Roman, 11pt
    legend.text = element_text(size = 9, color = "black"),      # Legend text in Times New Roman, 9pt
    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)  # Rotate x-axis labels for readability
  ) +
  scale_x_discrete(name = "Year", labels = unique(long_data$Year))

# Print the plot
print(Figure_2_1)

# Save the plot with smaller dimensions for better font scaling
ggsave("Figure_2_1.png", Figure_2_1, width = 7, height = 5, units = "in", bg = "white")

#this figure is the figure 2 (a) of the publication


```
#Plot_Reuse/Year
```{r}

# Calculate the frequency and percentage for each 'Reusability' score within each 'Year'
long_data <- data %>%
  count(Year, Reuse) %>%
  group_by(Year) %>%
  mutate(Percentage = n / sum(n) * 100) %>%
  mutate(Label = ifelse(Percentage > 5, paste0(round(Percentage, 1), "%"), "")) %>%
  mutate(Cumulative_Percentage = cumsum(Percentage) - (0.5 * Percentage)) %>%
  ungroup()

long_data <- long_data %>%
  mutate(Reuse = factor(Reuse, levels = c("4", "3", "2", "1")))

# Custom colors
colors <- c("#E88D5E","#B8D96C", "#B77AB9","#5271A9")

# Creating the stacked bar chart with percentage labels
Figure_2_2 <- ggplot(long_data, aes(x = as.factor(Year), y = n, fill = as.factor(Reuse))) +
  geom_bar(stat = "identity", position = "fill") +  # Scale the bar heights to proportions
  scale_y_continuous(labels = percent_format()) +  # Convert the y-axis to percentage
  geom_text(
    aes(label = Label, y = Percentage / 100),         # Adjust position within filled bars
    family = "Times New Roman",
    size = 3,                                         # Approximately 9pt
    color = "black", 
    position = position_fill(vjust = 0.5)
  ) +
  scale_fill_manual(values = colors) +
  labs(
    x = "Year",
    y = "Percentage",
    fill = "Reusability"
  ) +
  ggtitle("(b)") +                                    # Add title "(b)"
  theme_minimal(base_family = "Times New Roman") +    # Base font set to Times New Roman
  theme(
    plot.title = element_text(size = 11, hjust = 0, color = "black", family = "Times New Roman"),  # Title aligned left
    axis.title = element_text(size = 11, color = "black"),       # Axis titles in Times New Roman, 11pt
    axis.text = element_text(size = 9, color = "black"),         # Axis text in Times New Roman, 9pt
    legend.title = element_text(size = 11, color = "black"),     # Legend title in Times New Roman, 11pt
    legend.text = element_text(size = 9, color = "black"),       # Legend text in Times New Roman, 9pt
    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)  # Rotate x-axis labels for readability
  ) +
  scale_x_discrete(name = "Year", labels = unique(long_data$Year))

# Print the plot
print(Figure_2_2)

# Save the plot with smaller dimensions for better font scaling
ggsave("Figure_2_2.png", Figure_2_2, width = 7, height = 5, units = "in", bg = "white")
#this figure is the figure 2 (b) of the publication

```
#Plot_Access/Year
```{r}
# Calculate the frequency and percentage for each 'Accessibility' score within each 'Year'
long_data <- data %>%
  count(Year, Access) %>%
  group_by(Year) %>%
  mutate(Percentage = n / sum(n) * 100) %>%
  mutate(Label = ifelse(Percentage > 5, paste0(round(Percentage, 1), "%"), "")) %>%
  mutate(Cumulative_Percentage = cumsum(Percentage) - (0.5 * Percentage)) %>%
  ungroup()

long_data <- long_data %>%
  mutate(Access = factor(Access, levels = c("4", "3", "2", "1")))

# Custom colors
colors <- c("#E88D5E","#B8D96C", "#B77AB9","#5271A9")

# Creating the stacked bar chart with percentage labels
Figure_2_3 <- ggplot(long_data, aes(x = as.factor(Year), y = n, fill = as.factor(Access))) +
  geom_bar(stat = "identity", position = "fill") +  # Scale the bar heights to proportions
  scale_y_continuous(labels = percent_format()) +    # Convert the y-axis to percentage
  geom_text(
    aes(label = Label, y = Percentage / 100),         # Adjust position within filled bars
    family = "Times New Roman",
    size = 3,                                         # Approximately 9pt
    color = "black", 
    position = position_fill(vjust = 0.5)
  ) +
  scale_fill_manual(values = colors) +
  labs(
    x = "Year",
    y = "Percentage",
    fill = "Accessibility"
  ) +
  ggtitle("(c)") +                                    # Add title "(c)"
  theme_minimal(base_family = "Times New Roman") +    # Base font set to Times New Roman
  theme(
    plot.title = element_text(size = 11, hjust = 0, color = "black", family = "Times New Roman"),  # Title aligned left
    axis.title = element_text(size = 11, color = "black"),       # Axis titles in Times New Roman, 11pt
    axis.text = element_text(size = 9, color = "black"),         # Axis text in Times New Roman, 9pt
    legend.title = element_text(size = 11, color = "black"),     # Legend title in Times New Roman, 11pt
    legend.text = element_text(size = 9, color = "black"),       # Legend text in Times New Roman, 9pt
    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)  # Rotate x-axis labels for readability
  ) +
  scale_x_discrete(name = "Year", labels = unique(long_data$Year))

# Print the plot
print(Figure_2_3)

# Save the plot with smaller dimensions for better font scaling
ggsave("Figure_2_3.png", Figure_2_3, width = 7, height = 5, units = "in", bg = "white")
#this figure is the figure 2 (c) of the publication

```
#Plot_Licence/Year
```{r}
# Calculate the frequency and percentage for each 'Licence' score within each 'Year'
long_data <- data %>%
  count(Year, Licence) %>%
  group_by(Year) %>%
  mutate(Percentage = n / sum(n) * 100) %>%
  mutate(Label = ifelse(Percentage > 5, paste0(round(Percentage, 1), "%"), "")) %>%
  mutate(Cumulative_Percentage = cumsum(Percentage) - (0.5 * Percentage)) %>%
  ungroup()

long_data <- long_data %>%
  mutate(Licence = factor(Licence, levels = c("4", "3", "2", "1")))

# Custom colors
colors <- c("#E88D5E","#B8D96C", "#B77AB9","#5271A9")

# Creating the stacked bar chart with percentage labels
Figure_2_4 <- ggplot(long_data, aes(x = as.factor(Year), y = n, fill = as.factor(Licence))) +
  geom_bar(stat = "identity", position = "fill") +  # Scale the bar heights to proportions
  scale_y_continuous(labels = percent_format()) +  # Convert the y-axis to percentage
 geom_text(
    aes(label = Label, y = Percentage / 100),         # Adjust position within filled bars
    family = "Times New Roman",
    size = 3,                                         # Approximately 9pt
    color = "black", 
    position = position_fill(vjust = 0.5)
  ) +
  scale_fill_manual(values = colors) +
  labs(x = "Year",
       y = "Percentage",
       fill = "Licence") +
  ggtitle("(d)") +                                    # Add title "(c)"
  theme_minimal(base_family = "Times New Roman") +    # Base font set to Times New Roman
  theme(
    plot.title = element_text(size = 11, hjust = 0, color = "black", family = "Times New Roman"),  # Title aligned left
    axis.title = element_text(size = 11, color = "black"),       # Axis titles in Times New Roman, 11pt
    axis.text = element_text(size = 9, color = "black"),         # Axis text in Times New Roman, 9pt
    legend.title = element_text(size = 11, color = "black"),     # Legend title in Times New Roman, 11pt
    legend.text = element_text(size = 9, color = "black"),       # Legend text in Times New Roman, 9pt
    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)  # Rotate x-axis labels for readability
  ) +
  scale_x_discrete(name = "Year", labels = unique(long_data$Year))


# Print the plot
print(Figure_2_4)

ggsave("Figure_2_4.png", Figure_2_4, width = 7, height = 5, units = "in", bg = "white")

#this figure is the figure 2 (d) of the publication
```
#Plot_Criteria/Year
```{r}
library(patchwork)
Figure_2 <- Figure_2_1 + Figure_2_2 + Figure_2_3 + Figure_2_4 +
  plot_layout(
    ncol = 2, heights = c(10, 10), widths = c(10, 10)
  )
print(Figure_2)

ggsave("Figure_2.png", Figure_2, width = 14, height = 10, units = "in", bg = "white")

#these results were used in the Figure 2 of the publication
```



#Plot_DAS/Completeness Score
```{r}
# Transform the DAS variable
data <- data %>%
  mutate(NewDAS = case_when(
    is.na(DAS) ~ "Not Presented",
    DAS == 1 ~ "Shared",
    DAS == 0 ~ "Not Shared",
    TRUE ~ as.character(DAS)))  # This line is just a fallback to handle unexpected values

class(data$NewDAS)

# Convert the new DAS variable to a factor for plotting
data$NewDAS <- factor(data$NewDAS, levels = c("Not Presented", "Not Shared", "Shared"))

# Calculate frequency and percentage for each combination of 'Complete' score and 'NewDAS' status
das_frequency <- data %>%
  group_by(Complete, NewDAS) %>%
  summarise(Frequency = n(), .groups = 'drop') %>%
  mutate(Percentage = (Frequency / sum(Frequency)) * 100)

# Define specific colors for the new DAS values
colors <- c("Not Presented" = "gray", "Not Shared" = "#E5696F", "Shared" = "#50689B")

# Create the plot
Figure_4 <- ggplot(das_frequency, aes(x = as.factor(Complete), y = Frequency, fill = NewDAS)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = paste0(round(Percentage, 1), "% (", Frequency, ")")),
            position = position_dodge(width = 0.9), vjust = -0.25, size = 3, family = "Times New Roman", color = "black") +
  scale_fill_manual(values = colors, name = "DAS Status") +
  theme_bw(base_family = "Times New Roman") +  # Set theme to use Times New Roman as default
  theme(
    axis.title = element_text(size = 11, color = "black"),  # Axis title font size
    axis.text = element_text(size = 9, color = "black"),   # Axis text font size
    legend.title = element_text(size = 11, color = "black"), # Legend title font size
    legend.text = element_text(size = 9, color = "black"),  # Legend text font size
    legend.position = "bottom"  # Position legend at the bottom
  ) +
  labs(x = "Completeness Score", y = "Frequency")  # Label for x and y axes

# Print and save the plot with adjusted dimensions
print(Figure_4)
ggsave("Figure_4.png", Figure_4, width = 7, height = 5, units = "in", bg = "white")

#these results were not used, it was for illustration purposes 

```

```{r}
NewDAS_summary <- data %>%
  group_by(NewDAS) %>%
  summarise(count = n(), .groups = "drop") 

# Calculate the overall total
overall_total <- sum(NewDAS_summary$count)

# Add a column for the percentage of each DAS category relative to the overall total
NewDAS_summary <- NewDAS_summary %>%
  mutate(percentage = (count / overall_total) * 100)

print(NewDAS_summary)

#these results were used in table S4 of the publication
```



#2 - Ordinal regression models (Scoring Criteria and year)

```{r}
unique_authors <- unique(data$ResGrp)

# Get the total number of unique authors
num_unique_authors <- length(unique_authors)

# Print the number of unique authors
cat("Number of unique authors:", num_unique_authors, "\n")
```

#Ordinal regression model_Library
```{r}
library(ordinal) # ordinal logistic regression: cumulative link mixed models, clm function is in this package; For a detailed explanation of the package and the functions available see: https://cran.r-project.org/web/packages/ordinal/vignettes/clm_article.pdf
library(VGAM) # more ordinal regression 
library(dplyr) # Data manipulation
library(chisq.posthoc.test) # If needed
library(gmodels) # For SPSS style chi-sq/ contingency tables
library(emmeans)
library(sure)
library(ggplot2)


#link https://www.bookdown.org/rwnahhas/RMPH/blr-ordinal.html

```

```{r}
data$Complete <- factor(data$Complete, ordered = TRUE)
data$Reuse <- factor(data$Reuse, ordered = TRUE)
data$Access <- factor(data$Access, ordered = TRUE)
data$Licence <- factor(data$Licence, ordered = TRUE)

levels(data$Complete)
levels(data$Reuse)
levels(data$Access)
levels(data$Licence)
```

#Ordinal Regression Model(Completeness*Year)
```{r}
data$Y <- data$Year - 2013
m1a <- clm(Complete ~ Y, data = data)
summary_m1a <- summary(m1a) 
print(summary_m1a)

predict(m1a, newdata=expand.grid(Y = 1:10), se.fit=TRUE, type='cum.prob')

CI <-  confint(m1a)
data.frame(
  OR    = exp(m1a$coefficients),
  lower = exp(CI[1]),
  upper = exp(CI[2])
)

range(data$Y)

###plotting the model
# Predict probabilities for each level of 'Complete'
new_data <- data.frame(Y = sort(unique(data$Y)))
pred_probs <- predict(m1a, newdata = new_data, type = "prob")

# Add the 'Year' column to the predicted probabilities dataframe
pred_probs_df <- cbind(new_data, as.data.frame(pred_probs))

# Convert the predicted probabilities to a long format for ggplot
library(reshape2)
pred_probs_long <- melt(pred_probs_df, id.vars = 'Y', variable.name = 'CompleteLevel', value.name = 'PredictedProbability')

# Set the colors
my_colors <- c("#5271A9","#B77AB9","#B8D96C","#E88D5E")

# Modify ggplot command
Figure_3_1 <- ggplot(pred_probs_long, aes(x = Y, y = PredictedProbability, group = CompleteLevel, color = CompleteLevel)) + 
  geom_line(size = 2) +  # Thicker lines for readability
  scale_color_manual(values = my_colors) +
  scale_x_continuous(breaks = unique(pred_probs_long$Y)) +  # Display all unique x-axis labels
  labs(x = "Y", y = "Probability", color = "Completeness Score") +
  theme(
    axis.title = element_text(size = 11, family = "Times New Roman", color = "black"),  # Axis titles in 11pt
    axis.text = element_text(size = 9, family = "Times New Roman", color = "black"),   # Axis text in 9pt
    legend.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Legend title in 11pt
    legend.text = element_text(size = 9, family = "Times New Roman", color = "black")  # Legend text in 9pt
  ) 

# Print and save the plot
print(Figure_3_1)

ggsave("Figure_3_1.png", Figure_3_1, width = 7, height = 5, units = "in",  bg = "white")

#these results were used in the table s2
```



```{r}
# Calculate Odds Ratios and Confidence Intervals
coef_estimates <- coef(summary(m1a))  # Extract coefficients and standard errors
or <- exp(coef_estimates[, "Estimate"])  # Calculate Odds Ratios
se_log_or <- coef_estimates[, "Std. Error"]
lower_ci <- exp(coef_estimates[, "Estimate"] - 1.96 * se_log_or)
upper_ci <- exp(coef_estimates[, "Estimate"] + 1.96 * se_log_or)

# Creating a data frame to display Odds Ratios and 95% CIs nicely
results <- data.frame(
  OddsRatio = or,
  LowerCI = lower_ci,
  UpperCI = upper_ci
)
rownames(results) <- names(or)
print(results)

```

#Ordinal Regression Model(Completeness*Year) + Random Effect
```{r}
library(ordinal)
library(lme4)

# Assuming 'data' is your dataset with columns 'Complete', 'Year', 'ResGrp'

# Create a variable for years since 2013
data$Y <- data$Year - 2013

# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Complete ~ Y + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

# Calculate and print the odds ratios with confidence intervals
CI <- confint(m1a)
results <- data.frame(
  OR    = exp(summary_m1a$coefficients[, "Estimate"]),
  lower = exp(CI[, "2.5 %"]),
  upper = exp(CI[, "97.5 %"])
)
print(results)

#these results were used in the table s2

```


```{r}
library(mgcv)

mod_gam <- gam(Complete ~ Y+s(Y) + s(ResGrp, bs='re'), family=ocat(R=4),
    method='REML',
    data=data %>% mutate(Complete=as.numeric(Complete),
                         ResGrp = as.factor(ResGrp)))
print(mod_gam)

# Load the mgcv package if not already loaded
# library(mgcv)

# Plot smooth terms
par(mfrow = c(1, 2))  # Set up a 1x2 grid for plots

# Plot for s(Y)
plot(mod_gam, select = 2, main = "Smooth Term s(Y)")

# Plot for s(ResGrp)
plot(mod_gam, select = 3, main = "Smooth Term s(ResGrp)")

# Reset plotting layout
par(mfrow = c(1, 1))

#these results were used in the table s2


```


#Ordinal Regression Model(Reusability*Year)
```{r}
m1a <- clm(Reuse ~ Y, data = data)
summary_m1a <- summary(m1a) 
print(summary_m1a)

predict(m1a, newdata=expand.grid(Y = 1:10), se.fit=TRUE, type='cum.prob')

CI <-  confint(m1a)
data.frame(
  OR    = exp(m1a$coefficients),
  lower = exp(CI[1]),
  upper = exp(CI[2])
)

range(data$Y)

#these results were used in the table s2
```

#Ordinal Regression Model(Reusability*Year) + Random Effect
```{r}
# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Reuse ~ Y + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

# Calculate and print the odds ratios with confidence intervals
CI <- confint(m1a)
results <- data.frame(
  OR    = exp(summary_m1a$coefficients[, "Estimate"]),
  lower = exp(CI[, "2.5 %"]),
  upper = exp(CI[, "97.5 %"])
)
print(results)

#these results were used in the table s2
```

```{r}
mod_gam <- gam(Reuse ~ Y+s(Y) + s(ResGrp, bs='re'), family=ocat(R=4),
    method='REML',
    data=data %>% mutate(Reuse=as.numeric(Reuse),
                         ResGrp = as.factor(ResGrp)))
print(mod_gam)

# Load the mgcv package if not already loaded
# library(mgcv)

# Plot smooth terms
par(mfrow = c(1, 2))  # Set up a 1x2 grid for plots

# Plot for s(Y)
plot(mod_gam, select = 2, main = "Smooth Term s(Y)")

# Plot for s(ResGrp)
plot(mod_gam, select = 3, main = "Smooth Term s(ResGrp)")

# Reset plotting layout
par(mfrow = c(1, 1))

#these results were used in the table s2
```


#Ordinal Regression Model(Accessibility*Year)
```{r}
m1a <- clm(Access ~ Y, data = data)
summary_m1a <- summary(m1a) 
print(summary_m1a)

predict(m1a, newdata=expand.grid(Y = 1:10), se.fit=TRUE, type='cum.prob')

CI <-  confint(m1a)
data.frame(
  OR    = exp(m1a$coefficients),
  lower = exp(CI[1]),
  upper = exp(CI[2])
)

range(data$Y)
#these results were used in the table s2
```


#Ordinal Regression Model(Accessibility*Year) + Random Effect
```{r}
# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Access ~ Y + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

# Calculate and print the odds ratios with confidence intervals
CI <- confint(m1a)
results <- data.frame(
  OR    = exp(summary_m1a$coefficients[, "Estimate"]),
  lower = exp(CI[, "2.5 %"]),
  upper = exp(CI[, "97.5 %"])
)
print(results)
#these results were used in the table s2
```


```{r}
mod_gam <- gam(Access ~ Y+s(Y) + s(ResGrp, bs='re'), family=ocat(R=4),
    method='REML',
    data=data %>% mutate(Access=as.numeric(Access),
                         ResGrp = as.factor(ResGrp)))
print(mod_gam)

# Load the mgcv package if not already loaded
# library(mgcv)

# Plot smooth terms
par(mfrow = c(1, 2))  # Set up a 1x2 grid for plots

# Plot for s(Y)
plot(mod_gam, select = 2, main = "Smooth Term s(Y)")

# Plot for s(ResGrp)
plot(mod_gam, select = 3, main = "Smooth Term s(ResGrp)")

# Reset plotting layout
par(mfrow = c(1, 1))
#these results were used in the table s2


```
#Ordinal Regression Model(Licence*Year)
```{r}
m1a <- clm(Licence ~ Y, data = data)
summary_m1a <- summary(m1a) 
print(summary_m1a)

predict(m1a, newdata=expand.grid(Y = 1:10), se.fit=TRUE, type='cum.prob')

CI <-  confint(m1a)
data.frame(
  OR    = exp(m1a$coefficients),
  lower = exp(CI[1]),
  upper = exp(CI[2])
)

range(data$Y)
#these results were used in the table s2
```
#Ordinal Regression Model(Licence*Year) + Random Effect
```{r}
# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Licence ~ Y + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

# Calculate and print the odds ratios with confidence intervals
CI <- confint(m1a)
results <- data.frame(
  OR    = exp(summary_m1a$coefficients[, "Estimate"]),
  lower = exp(CI[, "2.5 %"]),
  upper = exp(CI[, "97.5 %"])
)
print(results)
#these results were used in the table s2
```

```{r}
mod_gam <- gam(Licence ~ Y+s(Y) + s(ResGrp, bs='re'), family=ocat(R=4),
    method='REML',
    data=data %>% mutate(Licence=as.numeric(Licence),
                         ResGrp = as.factor(ResGrp)))
print(mod_gam)

# Load the mgcv package if not already loaded
# library(mgcv)

# Plot smooth terms
par(mfrow = c(1, 2))  # Set up a 1x2 grid for plots

# Plot for s(Y)
plot(mod_gam, select = 2, main = "Smooth Term s(Y)")

# Plot for s(ResGrp)
plot(mod_gam, select = 3, main = "Smooth Term s(ResGrp)")

# Reset plotting layout
par(mfrow = c(1, 1))
#these results were used in the table s2


```



#Ordinal Regression Model(Complete*Type)

```{r} 
data$Type <- as.factor(data$Type)

levels(data$Type)

# Assuming 'data' is your dataframe containing the 'Type' and 'Complete' variables
data$Type <- relevel(data$Type, ref = "BioTech")

m1a <- clm(Complete ~ Type, data = data)
summary_m1a <- summary(m1a) 
print(summary_m1a)


coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)

data$Complete <- as.factor(data$Complete)

# Plot the distribution of completeness scores by type
Dist1 <- ggplot(data, aes(x = Complete, fill = Type)) +
  geom_bar(position = "dodge") +
  facet_wrap(~ Type) +
  labs(
    title = "(a)",  # Add title with "(a)"
    x = "Completeness Score",
    y = "Count"
  ) +
  theme(
    plot.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Title in 11pt
    axis.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Axis titles in 11pt
    axis.text = element_text(size = 9, family = "Times New Roman", color = "black"),   # Axis text in 9pt
    legend.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Legend title in 11pt
    legend.text = element_text(size = 9, family = "Times New Roman", color = "black")   # Legend text in 9pt
  )

# Print and save the plot with specified dimensions
print(Dist1)
ggsave("Dist1.png", Dist1, width = 7, height = 5, units = "in", bg = "white")

# These results were used in the figure s1 and table s3
```

#Ordinal Regression Model(Complete*Type) + Random Effect
```{r}
# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Complete ~ Type + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

# Calculate and print the odds ratios with confidence intervals
coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)

# These results were used in the figure s1 and table s3
```



#Ordinal Regression Model(Reusability*Type)
```{r}

# Assuming 'data' is your dataframe containing the 'Type' and 'Reusability' variables
data$Type <- relevel(data$Type, ref = "BioTech")

m1a <- clm(Reuse ~ Type, data = data)
summary_m1a <- summary(m1a) 
print(summary_m1a)


coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)

# Plot the distribution of completeness scores by type
Dist2 <- ggplot(data, aes(x = Reuse, fill = Type)) +
  geom_bar(position = "dodge") +
  facet_wrap(~ Type) +
  labs(
    title = "(b)",  
    x = "Reusability Score",
    y = "Count"
  ) +
  theme(
    plot.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Title in 11pt
    axis.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Axis titles in 11pt
    axis.text = element_text(size = 9, family = "Times New Roman", color = "black"),   # Axis text in 9pt
    legend.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Legend title in 11pt
    legend.text = element_text(size = 9, family = "Times New Roman", color = "black")   # Legend text in 9pt
  )

# Print and save the plot with specified dimensions
print(Dist2)
ggsave("Dist2.png", Dist2, width = 7, height = 5, units = "in", bg = "white")

# These results were used in the figure s1 and table s3
```

#Ordinal Regression Model(Reusability*Type) + Random Effect
```{r}
# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Reuse ~ Type + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)
# These results were used in the figure s1 and table s3
```
#?Ordinal Regression Model(Reusability*Type+ DAS + Prepeint) + Random Effect
```{r}

# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Reuse ~ Type + NewDAS + Preprints + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

# Calculate and print the odds ratios with confidence intervals
coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)
# These results were used in the figure s1 and table s3

```

#Ordinal Regression Model(Accessibility*Type)
```{r}
# Assuming 'data' is your dataframe containing the 'Type' and 'Access' variables
data$Type <- relevel(data$Type, ref = "BioTech")

m1a <- clm(Access ~ Type, data = data)
summary_m1a <- summary(m1a) 
print(summary_m1a)


coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)

# Plot the distribution of completeness scores by type
# Modify font size, font type, and add a title
Dist3 <- ggplot(data, aes(x = Access, fill = Type)) +
  geom_bar(position = "dodge") +
  facet_wrap(~ Type) +
  labs(
    title = "(c)",  # Add title with "(a)"
    x = "Accessibility Score",
    y = "Count"
  ) +
  theme(
    plot.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Title in 11pt
    axis.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Axis titles in 11pt
    axis.text = element_text(size = 9, family = "Times New Roman", color = "black"),   # Axis text in 9pt
    legend.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Legend title in 11pt
    legend.text = element_text(size = 9, family = "Times New Roman", color = "black")   # Legend text in 9pt
  )

# Print and save the plot with specified dimensions
print(Dist3)
ggsave("Dist3.png", Dist3, width = 7, height = 5, units = "in", bg = "white")
# These results were used in the figure s1 and table s3
```
#Ordinal Regression Model(Accessibility*Type) + Random Effect
```{r}
# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Access ~ Type + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)
# These results were used in the figure s1 and table s3
```
#?Ordinal Regression Model(Accessibility*Type+ DAS + Prepeint) + Random Effect
```{r}

# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Access ~ Type + NewDAS + Preprints + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

# Calculate and print the odds ratios with confidence intervals
coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)

# These results were used in the figure s1 and table s3
```

#Ordinal Regression Model(Licence*Type) 
```{r}
# Assuming 'data' is your dataframe containing the 'Type' and 'Licence' variables
data$Type <- relevel(data$Type, ref = "BioTech")

m1a <- clm(Licence ~ Type, data = data)
summary_m1a <- summary(m1a) 
print(summary_m1a)

coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)
# Plot the distribution of completeness scores by type
# Modify font size, font type, and add a title
Dist4 <- ggplot(data, aes(x = Licence, fill = Type)) +
  geom_bar(position = "dodge") +
  facet_wrap(~ Type) +
  labs(
    title = "(d)",  
    x = "Licence Score",
    y = "Count"
  ) +
  theme(
    plot.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Title in 11pt
    axis.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Axis titles in 11pt
    axis.text = element_text(size = 9, family = "Times New Roman", color = "black"),   # Axis text in 9pt
    legend.title = element_text(size = 11, family = "Times New Roman", color = "black"), # Legend title in 11pt
    legend.text = element_text(size = 9, family = "Times New Roman", color = "black")   # Legend text in 9pt
  )

# Print and save the plot with specified dimensions
print(Dist4)
ggsave("Dist4.png", Dist4, width = 7, height = 5, units = "in", bg = "white")
# These results were used in the figure s1 and table s3

```

#Ordinal Regression Model(Licence*Type) + Random Effect
```{r}
# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Licence ~ Type + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)
# These results were used in the figure s1 and table s3
```

```{r}
Dist <- Dist1 + Dist2 + Dist3 + Dist4 +
  plot_layout(
    ncol = 2, heights = c(10, 10), widths = c(10, 10)
  )
print(Dist)

ggsave("Dist.png", Dist, width = 14, height = 10, units = "in")
# These results were used in the figure s1
```


#Ordinal Regression Model(Complete*DAS + Prepeint) + Random Effect
```{r}

data$NewDAS <- as.factor(data$NewDAS)
data$Preprints <- as.factor(data$Preprints)

# Set "NA" as the reference level
data$NewDAS <- relevel(data$NewDAS, ref = "Not Presented")

# Verify the levels
levels(data$NewDAS)


# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Complete ~  NewDAS + Preprints + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

# Calculate and print the odds ratios with confidence intervals
coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)

#these results were used in Table s5
```
#Ordinal Regression Model(Reusability*DAS + Prepeint) + Random Effect
```{r}

data$NewDAS <- as.factor(data$NewDAS)
data$Preprints <- as.factor(data$Preprints)

# Set "NA" as the reference level
data$NewDAS <- relevel(data$NewDAS, ref = "Not Presented")

# Verify the levels
levels(data$NewDAS)


# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Reuse ~  NewDAS + Preprints + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

# Calculate and print the odds ratios with confidence intervals
coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)

#these results were used in Table s5
```
#Ordinal Regression Model(Accessibility*DAS + Prepeint) + Random Effect
```{r}

data$NewDAS <- as.factor(data$NewDAS)
data$Preprints <- as.factor(data$Preprints)

# Set "NA" as the reference level
data$NewDAS <- relevel(data$NewDAS, ref = "Not Presented")

# Verify the levels
levels(data$NewDAS)


# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Access ~  NewDAS + Preprints + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

# Calculate and print the odds ratios with confidence intervals
coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)

#these results were used in Table s5
```

#Ordinal Regression Model(Licence*DAS + Prepeint) + Random Effect
```{r}

data$NewDAS <- as.factor(data$NewDAS)
data$Preprints <- as.factor(data$Preprints)

# Set "NA" as the reference level
data$NewDAS <- relevel(data$NewDAS, ref = "Not Presented")

# Verify the levels
levels(data$NewDAS)


# Fit a mixed-effects ordinal regression model with random intercepts for authors
m1a <- clmm(Licence ~  NewDAS + Preprints + (1 | ResGrp), data = data)

# Print the summary of the model
summary_m1a <- summary(m1a)
print(summary_m1a)
print(summary_m1a$ranef.var)

# Calculate and print the odds ratios with confidence intervals
coefficients <- summary_m1a$coefficients
coef_estimates <- coefficients[, "Estimate"]
coef_se <- coefficients[, "Std. Error"]

# Calculate odds ratios
odds_ratios <- exp(coef_estimates)

# Calculate the 95% confidence intervals
lower_ci <- exp(coef_estimates - 1.96 * coef_se)
upper_ci <- exp(coef_estimates + 1.96 * coef_se)

# Combine into a data frame for easier viewing
results <- data.frame(
  Coefficient = coef_estimates,
  OR = odds_ratios,
  Lower_CI = lower_ci,
  Upper_CI = upper_ci
)

# Print the results
print(results)

#these results were used in Table s5
```




#Complete/ResGrp

```{r}
 #Calculate the frequency and percentage for each 'Complete' score among the research Group
long_data <- data %>%
  count(ResGrp, Complete) %>%
  group_by(ResGrp) %>%
  mutate(Percentage = n / sum(n) * 100) %>%
  mutate(Label = ifelse(Percentage > 5, paste0(round(Percentage, 1), "%"), "")) %>%
  mutate(Cumulative_Percentage = cumsum(Percentage) - (0.5 * Percentage)) %>%
  ungroup()

long_data <- long_data %>%
  mutate(Complete = factor(Complete, levels = c("4", "3", "2", "1")))

# Custom colors
colors <- c("#E88D5E","#B8D96C", "#B77AB9","#5271A9")

# Creating the stacked bar chart with percentage labels
internal1 <- ggplot(long_data, aes(x = as.factor(ResGrp), y = n, fill = as.factor(Complete))) +
  geom_bar(stat = "identity", position = "fill") +  # Scale the bar heights to proportions
  scale_y_continuous(labels = percent_format()) +  # Convert the y-axis to percentage
  scale_fill_manual(values = colors) +
  labs(title = "Distribution of 'Completeness' Scores by ResGrp",
       x = "ResGrp",
       y = "Proportion",
       fill = "Complete") +
  theme_minimal() +
  scale_x_discrete(name = "ResGrp", labels = unique(long_data$ResGrp)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))  # Adjust text angle for readability

# Print the plot
print(internal1)

ggsave("internal1.png", internal1, width = 15, height = 10, units = "in", bg= "white")


#these results were used for internal university meetings and presentations 
```

#Reuse/ResGrp
```{r}
#Calculate the frequency and percentage for each 'Complete' score among the research Group
long_data <- data %>%
  count(ResGrp, Reuse) %>%
  group_by(ResGrp) %>%
  mutate(Percentage = n / sum(n) * 100) %>%
  mutate(Label = ifelse(Percentage > 5, paste0(round(Percentage, 1), "%"), "")) %>%
  mutate(Cumulative_Percentage = cumsum(Percentage) - (0.5 * Percentage)) %>%
  ungroup()

long_data <- long_data %>%
  mutate(Reuse = factor(Reuse, levels = c("4", "3", "2", "1")))

# Custom colors
colors <- c("#E88D5E","#B8D96C", "#B77AB9","#5271A9")

# Creating the stacked bar chart with percentage labels
internal2 <- ggplot(long_data, aes(x = as.factor(ResGrp), y = n, fill = as.factor(Reuse))) +
  geom_bar(stat = "identity", position = "fill") +  # Scale the bar heights to proportions
  scale_y_continuous(labels = percent_format()) +  # Convert the y-axis to percentage
  scale_fill_manual(values = colors) +
  labs(title = "Distribution of 'Completeness' Scores by ResGrp",
       x = "ResGrp",
       y = "Proportion",
       fill = "Reuse") +
  theme_minimal() +
  scale_x_discrete(name = "ResGrp", labels = unique(long_data$ResGrp)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))  # Adjust text angle for readability

# Print the plot
print(internal2)

ggsave("internal2.png", internal2, width = 15, height = 10, units = "in", bg= "white")


#these results were used for internal university meetings and presentations 
```

#Access/ResGrp
```{r}
#Calculate the frequency and percentage for each 'Complete' score among the research Group
long_data <- data %>%
  count(ResGrp, Access) %>%
  group_by(ResGrp) %>%
  mutate(Percentage = n / sum(n) * 100) %>%
  mutate(Label = ifelse(Percentage > 5, paste0(round(Percentage, 1), "%"), "")) %>%
  mutate(Cumulative_Percentage = cumsum(Percentage) - (0.5 * Percentage)) %>%
  ungroup()

long_data <- long_data %>%
  mutate(Access = factor(Access, levels = c("4", "3", "2", "1")))

# Custom colors
colors <- c("#E88D5E","#B8D96C", "#B77AB9","#5271A9")

# Creating the stacked bar chart with percentage labels
internal3 <- ggplot(long_data, aes(x = as.factor(ResGrp), y = n, fill = as.factor(Access))) +
  geom_bar(stat = "identity", position = "fill") +  # Scale the bar heights to proportions
  scale_y_continuous(labels = percent_format()) +  # Convert the y-axis to percentage
  scale_fill_manual(values = colors) +
  labs(title = "Distribution of 'Completeness' Scores by ResGrp",
       x = "ResGrp",
       y = "Proportion",
       fill = "Access") +
  theme_minimal() +
  scale_x_discrete(name = "ResGrp", labels = unique(long_data$ResGrp)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))  # Adjust text angle for readability

# Print the plot
print(internal3)

ggsave("internal3.png", internal3, width = 15, height = 10, units = "in", bg= "white")


#these results were used for internal university meetings and presentations 
```

#Licence/ResGrp
```{r}
#Calculate the frequency and percentage for each 'Complete' score among the research Group
long_data <- data %>%
  count(ResGrp, Licence) %>%
  group_by(ResGrp) %>%
  mutate(Percentage = n / sum(n) * 100) %>%
  mutate(Label = ifelse(Percentage > 5, paste0(round(Percentage, 1), "%"), "")) %>%
  mutate(Cumulative_Percentage = cumsum(Percentage) - (0.5 * Percentage)) %>%
  ungroup()

long_data <- long_data %>%
  mutate(Licence = factor(Licence, levels = c("4", "3", "2", "1")))

# Custom colors
colors <- c("#E88D5E","#B8D96C", "#B77AB9","#5271A9")

# Creating the stacked bar chart with percentage labels
internal4 <- ggplot(long_data, aes(x = as.factor(ResGrp), y = n, fill = as.factor(Licence))) +
  geom_bar(stat = "identity", position = "fill") +  # Scale the bar heights to proportions
  scale_y_continuous(labels = percent_format()) +  # Convert the y-axis to percentage
  scale_fill_manual(values = colors) +
  labs(title = "Distribution of 'Completeness' Scores by ResGrp",
       x = "ResGrp",
       y = "Proportion",
       fill = "Licence") +
  theme_minimal() +
  scale_x_discrete(name = "ResGrp", labels = unique(long_data$ResGrp)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))  # Adjust text angle for readability

# Print the plot
print(internal4)

ggsave("internal4.png", internal4, width = 15, height = 10, units = "in", bg= "white")


#these results were used for internal university meetings and presentations 
```


#ODDPub_Figures
```{r}
ODD <- read.csv ("OpenScienceData_Nov_2024+ODDPub.csv")
head(ODD)

#this is the dataset with the ODDPub results
```
```{r}
ODD$Count <- 1

# Now calculate counts and percentages for each combination of 'Complete' and 'is_open_data'
Counts <- aggregate(Count ~ Complete + is_open_data, data = ODD, FUN = sum)

Counts$Percentage <- with(Counts, ave(Count, Complete, FUN = function(x) round(x / sum(x) * 100, 1)))

# Create the adjusted bar chart for the revised request
p <- ggplot(Counts, aes(x = Complete, y = Count, fill = is_open_data)) +
  geom_bar(stat = "identity") +
  geom_text(
    aes(label = paste(Percentage, "% (", Count, ")")),
    position = position_stack(vjust = 0.5),
    size = 4,  # Adjust text size for readability
    color = "black"
  ) +
  scale_fill_manual(
    values = c("TRUE" = "#50689B", "FALSE" = "#E5696F"),
    name = "ODDPub Open Data"
  ) +
  labs(
    title = "(a)",  
    x = "Completeness",
    y = "Count"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 11, family = "Times New Roman", color = "black"),  # Title font size and style
    axis.title.x = element_text(size = 11, family = "Times New Roman", color = "black"),  # X-axis title font
    axis.title.y = element_text(size = 11, family = "Times New Roman", color = "black"),  # Y-axis title font
    axis.text.x = element_text(size = 11, family = "Times New Roman", color = "black"),   # X-axis text size and font
    axis.text.y = element_text(size = 11, family = "Times New Roman", color = "black"),   # Y-axis text size and font
    legend.title = element_text(size = 11, family = "Times New Roman", color = "black"),  # Legend title font
    legend.text = element_text(size = 11, family = "Times New Roman", color = "black"),    # Legend text font
    legend.position = "bottom"  # Legend position moved below the plot
  )

# Print and save the plot
print(p)
ggsave("Figure_a.png", p, width = 5, height = 7, units = "in", bg = "white")

#these results were used in figure 3 (a)

```

```{r}
ODD <- ODD %>%
  mutate(Newcode = case_when(
    is.na(Code) ~ "Not Applicable",
    Code == 1 ~ "Used & Shared",
    Code == 0 ~ "Used & not Shared",
    TRUE ~ as.character(Code)))  # This line is just a fallback to handle unexpected values

Counts <- aggregate(Count ~ Newcode + is_open_code, data = ODD, FUN = sum)
Counts$Percentage <- with(Counts, ave(Count, Newcode, FUN = function(x) round(x / sum(x) * 100, 1)))

# Create the adjusted bar chart for the revised request
p1 <- ggplot(Counts, aes(x = Newcode, y = Count, fill = is_open_code)) +
  geom_bar(stat = "identity") +
  geom_text(
    aes(label = paste(Percentage, "% (", Count, ")")),
    position = position_stack(vjust = 0.5),
    size = 4,  # Adjusted text size for readability
    color = "black"
  ) +
  scale_fill_manual(
    values = c("TRUE" = "#50689B", "FALSE" = "#E5696F"),
    name = "ODDPub Code"
  ) +
  labs(
    title = "(b)",  # Updated title
    x = "Manual Code",
    y = "Count"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 11, family = "Times New Roman", color = "black"),  # Title font size and style
    axis.title.x = element_text(size = 11, family = "Times New Roman", color = "black"),  # X-axis title font
    axis.title.y = element_text(size = 11, family = "Times New Roman", color = "black"),  # Y-axis title font
    axis.text.x = element_text(size = 11, family = "Times New Roman", color = "black"),   # X-axis text size and font
    axis.text.y = element_text(size = 11, family = "Times New Roman", color = "black"),   # Y-axis text size and font
    legend.title = element_text(size = 11, family = "Times New Roman", color = "black"),  # Legend title font
    legend.text = element_text(size = 11, family = "Times New Roman", color = "black"),    # Legend text font
    legend.position = "bottom"  # Legend position moved below the plot
  )

# Print and save the plot
print(p1)
ggsave("Figure_b.png", p1, width = 5, height = 7, units = "in", bg = "white")
#these results were used in figure 3 (b)

```

```{r}
Figure_O1 <- p + p1
  plot_layout(
    ncol = 2, heights = c(10, 10), widths = c(10, 10)
  )
print(Figure_O1)

ggsave("Figure_O1.png", Figure_O1, width = 10, height = 7, units = "in")
#these results were used in figure 3
```

```{r}
ODD <- ODD %>%
  mutate(NewDAS = case_when(
    is.na(DAS) ~ "Not Presented",
    DAS == 1 ~ "Shared",
    DAS == 0 ~ "Not Shared",
    TRUE ~ as.character(DAS)))  # This line is just a fallback to handle unexpected values

class(ODD$NewDAS)

ODD$ODD_DAS[is.na(ODD$ODD_DAS)] <- "FALSE"

# Calculate the counts and percentages for the DAS dataset
CountsDAS <- aggregate(Count ~ NewDAS + ODD_DAS, data = ODD, FUN = sum)
CountsDAS$Percentage <- with(CountsDAS, ave(Count, NewDAS, FUN = function(x) round(x / sum(x) * 100, 1)))

# Create the bar chart for the DAS dataset
pDAS <- ggplot(CountsDAS, aes(x = NewDAS, y = Count, fill = ODD_DAS)) +
  geom_bar(stat = "identity") +
  geom_text(
    aes(label = paste(Percentage, "% (", Count, ")")),
    position = position_stack(vjust = 0.5),
    size = 4,  # Adjusted text size for better readability
    color = "black"
  ) +
  scale_fill_manual(
    values = c("TRUE" = "#50689B", "FALSE" = "#E5696F"),
    name = "ODDPub DAS"
  ) +
  labs(
    title = "(b)",  # Updated title with "(b)"
    x = "DAS Manual",
    y = "Count"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 11, family = "Times New Roman", color = "black"),  # Title font size and style
    axis.title.x = element_text(size = 11, family = "Times New Roman", color = "black"),  # X-axis title font
    axis.title.y = element_text(size = 11, family = "Times New Roman", color = "black"),  # Y-axis title font
    axis.text.x = element_text(size = 11, family = "Times New Roman", color = "black"),   # X-axis text font
    axis.text.y = element_text(size = 11, family = "Times New Roman", color = "black"),   # Y-axis text font
    legend.title = element_text(size = 11, family = "Times New Roman", color = "black"),  # Legend title font
    legend.text = element_text(size = 11, family = "Times New Roman", color = "black"),    # Legend text font
    legend.position = "bottom"  # Move legend to bottom for consistent layout
  )

# Print and save the plot
print(pDAS)
ggsave("Figure_b_DAS.png", pDAS, width = 5, height = 7, units = "in", bg = "white")
#these results were used in figure 4 (b)

```
```{r}
# Update the code to format the percentage to display only two digits after the comma

das_counts <- data %>%
  group_by(Complete, NewDAS) %>%
  summarise(Count = n(), .groups = 'drop') %>%
  mutate(Total = sum(Count), Frequency = Count, Percentage = round((Count / Total) * 100, 2))  # Round to two decimal places

# Define colors matching the correct sequence of 'Complete' levels
colors <- setNames(c("#E88D5E", "#B8D96C", "#B77AB9", "#5271A9"), levels(factor(das_counts$Complete, levels = c("4", "3", "2", "1"))))

# Modify the plot to include the adjusted percentage
pData1 <- ggplot(das_counts, aes(x = NewDAS, y = Count, fill = factor(Complete, levels = c("1", "2", "3", "4")))) +
  geom_bar(stat = "identity", position = "stack") +
  geom_text(
    aes(label = paste(Percentage, "% (", Count, ")")),
    position = position_stack(vjust = 0.5),
    check_overlap = TRUE,
    size = 4,  # Adjusted text size for better readability
    color = "black"
  ) +
  scale_fill_manual(
    values = colors,
    name = "Complete Score"
  ) +
  labs(
    title = "(a)",  # Updated title with "(a)"
    x = "DAS Manual",
    y = "Count"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 11, family = "Times New Roman", color = "black"),  # Title font size and style
    axis.title.x = element_text(size = 11, family = "Times New Roman", color = "black"),  # X-axis title font
    axis.title.y = element_text(size = 11, family = "Times New Roman", color = "black"),  # Y-axis title font
    axis.text.x = element_text(size = 11, family = "Times New Roman", color = "black"),    # X-axis text font
    axis.text.y = element_text(size = 11, family = "Times New Roman", color = "black"),    # Y-axis text font
    legend.title = element_text(size = 11, family = "Times New Roman", color = "black"),  # Legend title font
    legend.text = element_text(size = 11, family = "Times New Roman", color = "black"),    # Legend text font
    legend.position = "bottom"  # Place legend below the plot for consistent layout
  )

# Print and save the plot
print(pData1)
ggsave("Figure_a_DAS.png", pData1, width = 5, height = 7, units = "in", bg = "white")

#these results were used in figure 4 (a)

```
```{r}
library(patchwork)
Figure_O2 <- pData1 + pDAS
  plot_layout(
    ncol = 2, heights = c(10, 10), widths = c(10, 10)
  )
print(Figure_O2)

ggsave("Figure_O2.png", Figure_O2, width = 10, height = 7, units = "in")
#these results were used in figure 4
```



